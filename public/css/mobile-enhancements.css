/* ===================================
   ROSEC MOBILE ENHANCEMENTS
   Comprehensive mobile optimization
   HIGHEST PRIORITY - OVERRIDES ALL
   =================================== */

/* Force mobile styles to take precedence */
html.mobile-enhanced,
html.mobile-enhanced body,
html.mobile-enhanced * {
  box-sizing: border-box !important;
}

/* ===================================
   GLOBAL MOBILE OPTIMIZATIONS
   =================================== */

/* Hide any existing enhanced features notifications */
.enhanced-features-welcome {
  display: none !important;
}

/* ===================================
   LANDSCAPE ORIENTATION PROMPT
   =================================== */

/* Landscape orientation prompt - only show on mobile portrait */
.landscape-prompt {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, #1a73e8, #4285f4);
  color: white;
  z-index: 10000;
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 20px;
}

.landscape-prompt-content {
  max-width: 300px;
}

.landscape-prompt h2 {
  font-size: 24px;
  margin-bottom: 15px;
  font-weight: 700;
}

.landscape-prompt p {
  font-size: 16px;
  margin-bottom: 20px;
  opacity: 0.9;
  line-height: 1.5;
}

.landscape-prompt-icon {
  font-size: 48px;
  margin-bottom: 20px;
  animation: rotateDevice 2s ease-in-out infinite;
}

.landscape-prompt-dismiss {
  background: rgba(255, 255, 255, 0.2);
  border: 2px solid rgba(255, 255, 255, 0.3);
  color: white;
  padding: 12px 24px;
  border-radius: 25px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s ease;
  margin-top: 15px;
}

.landscape-prompt-dismiss:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
}

@keyframes rotateDevice {
  0%, 100% { transform: rotate(0deg); }
  25% { transform: rotate(-10deg); }
  75% { transform: rotate(10deg); }
}

/* Show landscape prompt on mobile portrait only */
@media (max-width: 768px) and (orientation: portrait) {
  .landscape-prompt.show {
    display: flex !important;
  }
  
  /* Hide main content when landscape prompt is shown */
  body.landscape-prompt-active {
    overflow: hidden;
  }
  
  body.landscape-prompt-active > *:not(.landscape-prompt) {
    display: none !important;
  }
}

/* Hide prompt in landscape mode */
@media (max-width: 768px) and (orientation: landscape) {
  .landscape-prompt {
    display: none !important;
  }
  
  /* Optimize layout for landscape mobile */
  .main-area {
    padding-top: 60px !important;
  }
  
  .header {
    padding: 8px 16px 8px 60px !important;
  }
  
  .sidebar {
    width: 280px !important;
  }
  
  .sidebar .sidebar-nav {
    padding: 10px 0 !important;
  }
  
  /* Compact cards in landscape */
  .action-card-modern {
    padding: 15px !important;
  }
  
  .card {
    margin-bottom: 12px !important;
  }
}

/* Improved touch targets for all interactive elements */
@media (max-width: 768px) {
  /* Ensure all clickable elements meet minimum 44px touch target */
  button, 
  .btn, 
  input[type="submit"], 
  input[type="button"], 
  .nav-link, 
  .user-profile-btn,
  .sidebar-toggle,
  .mobile-menu-toggle,
  .dropdown-item,
  .nav-btn,
  .actions-btn,
  .delete-btn,
  .fab,
  select,
  input[type="checkbox"],
  input[type="radio"] {
    min-height: 44px !important;
    min-width: 44px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 12px 16px !important;
    touch-action: manipulation !important;
  }

  /* Prevent zoom on form inputs */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="number"],
  input[type="tel"],
  input[type="url"],
  textarea,
  select {
    font-size: 16px !important;
    -webkit-text-size-adjust: 100% !important;
    -webkit-appearance: none !important;
    appearance: none !important;
  }

  /* Improve form spacing */
  .form-row,
  .field {
    margin-bottom: 20px !important;
  }

  /* Better button spacing */
  .btn + .btn {
    margin-left: 12px !important;
  }
}

/* ===================================
   ENHANCED MOBILE NAVIGATION
   =================================== */

@media (max-width: 1024px) {
  /* Override modern-sidebar.css - FORCE MOBILE BEHAVIOR */
  html.mobile-enhanced .sidebar {
    transform: translateX(-100%) !important;
    z-index: 1001 !important;
    position: fixed !important;
    display: flex !important;
    visibility: visible !important;
  }
  
  html.mobile-enhanced .sidebar.mobile-open {
    transform: translateX(0) !important;
    display: flex !important;
    visibility: visible !important;
  }
}

@media (max-width: 768px) {
  /* Improved mobile menu button */
  .mobile-menu-toggle,
  .sidebar-toggle {
    position: fixed !important;
    top: 16px !important;
    left: 16px !important;
    z-index: 1002 !important;
    background: linear-gradient(135deg, #1a73e8, #4285f4) !important;
    color: white !important;
    border: none !important;
    width: 48px !important;
    height: 48px !important;
    border-radius: 12px !important;
    box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3) !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 18px !important;
    cursor: pointer !important;
  }

  .mobile-menu-toggle:active,
  .sidebar-toggle:active {
    transform: scale(0.95) !important;
  }

  .mobile-menu-toggle:active,
  .sidebar-toggle:active {
    transform: scale(0.95) !important;
  }

  /* Enhanced sidebar for mobile - FORCE VISIBILITY */
  .sidebar {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 320px !important;
    height: 100vh !important;
    transform: translateX(-100%) !important;
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    z-index: 1001 !important;
    box-shadow: 4px 0 20px rgba(0, 0, 0, 0.15) !important;
    backdrop-filter: blur(20px) !important;
    display: flex !important;
    flex-direction: column !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  .sidebar.mobile-open {
    transform: translateX(0) !important;
    display: flex !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Force sidebar to override any hiding styles */
  html.mobile-enhanced .sidebar {
    display: flex !important;
    visibility: visible !important;
  }

  html.mobile-enhanced .sidebar.mobile-open {
    transform: translateX(0) !important;
    display: flex !important;
  }

  /* Force sidebar header to not scroll */
  .sidebar .sidebar-header {
    flex-shrink: 0 !important;
    overflow: visible !important;
  }

  /* FORCE SIDEBAR SCROLLING ON MOBILE */
  html.mobile-enhanced .sidebar .sidebar-nav {
    flex: 1 !important;
    overflow-y: scroll !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    padding-bottom: 20px !important;
    scrollbar-width: thin !important;
    scrollbar-color: rgba(255, 255, 255, 0.3) transparent !important;
    height: calc(100vh - 120px) !important;
    max-height: calc(100vh - 120px) !important;
  }

  /* Force scrolling when sidebar is open */
  html.mobile-enhanced .sidebar.mobile-open .sidebar-nav {
    overflow-y: scroll !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    height: calc(100vh - 120px) !important;
    max-height: calc(100vh - 120px) !important;
  }

  /* Webkit scrollbar styling for sidebar */
  html.mobile-enhanced .sidebar .sidebar-nav::-webkit-scrollbar {
    width: 6px !important;
  }

  html.mobile-enhanced .sidebar .sidebar-nav::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1) !important;
    border-radius: 3px !important;
  }

  html.mobile-enhanced .sidebar .sidebar-nav::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.4) !important;
    border-radius: 3px !important;
  }

  html.mobile-enhanced .sidebar .sidebar-nav::-webkit-scrollbar-thumb:hover {
    background: rgba(255, 255, 255, 0.6) !important;
  }

  /* Force all nav items to be visible and scrollable */
  html.mobile-enhanced .sidebar .nav-item {
    flex-shrink: 0 !important;
    min-height: auto !important;
  }

  html.mobile-enhanced .sidebar .nav-section {
    flex-shrink: 0 !important;
  }

  /* Ensure sidebar header doesn't interfere with scrolling */
  html.mobile-enhanced .sidebar .sidebar-header {
    flex-shrink: 0 !important;
    overflow: visible !important;
    position: relative !important;
    z-index: 2 !important;
  }

  /* Force sidebar container to be flex */
  html.mobile-enhanced .sidebar {
    display: flex !important;
    flex-direction: column !important;
  }

  /* Ensure sidebar toggle is visible and working */
  .sidebar-toggle {
    display: block !important;
    position: fixed !important;
    top: 16px !important;
    left: 16px !important;
    z-index: 1002 !important;
    background: linear-gradient(135deg, #1a73e8, #4285f4) !important;
    color: white !important;
    border: none !important;
    width: 48px !important;
    height: 48px !important;
    border-radius: 12px !important;
    box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3) !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  }

  /* Mobile overlay for sidebar */
  .mobile-overlay {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background: rgba(0, 0, 0, 0.5) !important;
    z-index: 1000 !important;
    opacity: 0 !important;
    visibility: hidden !important;
    transition: all 0.3s ease !important;
  }

  .mobile-overlay.active {
    opacity: 1 !important;
    visibility: visible !important;
  }

  /* Main area adjustments */
  .main-area {
    margin-left: 0 !important;
    width: 100% !important;
    padding-top: 80px !important;
  }
}

/* ===================================
   MOBILE TABLE ENHANCEMENTS
   =================================== */

@media (max-width: 768px) {
  /* Responsive table wrapper */
  .table-container {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    border-radius: 12px !important;
    margin: 0 16px 20px !important;
  }

  /* Table improvements */
  .exams-table,
  table {
    min-width: 600px !important;
    font-size: 14px !important;
  }

  .exams-table th,
  .exams-table td,
  th,
  td {
    padding: 12px 8px !important;
    white-space: nowrap !important;
  }

  .exams-table th {
    font-size: 12px !important;
    position: sticky !important;
    top: 0 !important;
    background: #f8f9fa !important;
    z-index: 10 !important;
  }

  /* Horizontal scroll indicator */
  .table-container::after {
    content: "← Scroll to see more →" !important;
    position: absolute !important;
    bottom: 8px !important;
    right: 8px !important;
    background: rgba(0, 0, 0, 0.7) !important;
    color: white !important;
    padding: 4px 8px !important;
    border-radius: 4px !important;
    font-size: 11px !important;
    opacity: 0.8 !important;
    pointer-events: none !important;
  }
}

/* ===================================
   MOBILE FORM ENHANCEMENTS
   =================================== */

@media (max-width: 768px) {
  /* Form container improvements */
  .controls,
  .form-row {
    display: flex !important;
    flex-direction: column !important;
    gap: 16px !important;
    padding: 20px 16px !important;
  }

  /* Grid forms to single column */
  .controls {
    grid-template-columns: 1fr !important;
  }

  /* Better form field styling */
  .field {
    width: 100% !important;
  }

  /* Improved select dropdowns */
  select {
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e") !important;
    background-repeat: no-repeat !important;
    background-position: right 12px center !important;
    background-size: 16px !important;
    padding-right: 40px !important;
  }

  /* Button groups */
  .button-group {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important;
    width: 100% !important;
  }

  .button-group .btn {
    width: 100% !important;
    justify-content: center !important;
  }
}

/* ===================================
   MOBILE MODAL ENHANCEMENTS
   =================================== */

@media (max-width: 768px) {
  /* Modal improvements */
  .modal-overlay {
    padding: 16px !important;
    align-items: flex-end !important;
  }

  .modal,
  .exam-sheet-modal {
    width: 100% !important;
    max-width: none !important;
    max-height: 90vh !important;
    margin: 0 !important;
    border-radius: 16px 16px 0 0 !important;
    animation: slideUpMobile 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
  }

  @keyframes slideUpMobile {
    from {
      transform: translateY(100%) !important;
      opacity: 0 !important;
    }
    to {
      transform: translateY(0) !important;
      opacity: 1 !important;
    }
  }

  /* Modal header improvements */
  .modal-header {
    padding: 20px 16px !important;
    position: sticky !important;
    top: 0 !important;
    background: white !important;
    z-index: 10 !important;
    border-bottom: 1px solid #e0e0e0 !important;
  }

  .modal-close {
    width: 40px !important;
    height: 40px !important;
    border-radius: 50% !important;
    background: #f1f3f4 !important;
  }

  /* Modal content */
  .modal-content,
  .exam-sheet-content {
    padding: 16px !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
}

/* ===================================
   MOBILE CARD ENHANCEMENTS
   =================================== */

@media (max-width: 768px) {
  /* Card improvements */
  .card,
  .exam-card,
  .action-card-modern {
    margin: 0 16px 16px !important;
    border-radius: 12px !important;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08) !important;
  }

  /* Action cards grid */
  .action-cards-grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 16px !important;
    padding: 16px !important;
  }

  .action-card-modern {
    margin: 0 !important;
    padding: 20px !important;
  }

  /* Content grid to single column */
  .content-grid {
    grid-template-columns: 1fr !important;
    gap: 16px !important;
    padding: 16px !important;
  }
}

/* ===================================
   MOBILE HEADER ENHANCEMENTS
   =================================== */

@media (max-width: 768px) {
  /* Header improvements */
  .header {
    padding: 12px 16px 12px 70px !important;
    flex-wrap: wrap !important;
    gap: 12px !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 100 !important;
  }

  .header-left {
    flex: 1 !important;
    min-width: 0 !important;
  }

  .header-title h1 {
    font-size: 20px !important;
    line-height: 1.2 !important;
  }

  .header-title p {
    font-size: 13px !important;
  }

  /* User section mobile */
  .user-section {
    flex-shrink: 0 !important;
  }

  .user-profile-btn {
    min-width: 160px !important;
    padding: 8px 12px !important;
  }

  .user-avatar {
    width: 36px !important;
    height: 36px !important;
    font-size: 16px !important;
  }

  .user-name {
    font-size: 14px !important;
    max-width: 80px !important;
  }

  .user-role-badge {
    font-size: 10px !important;
    padding: 2px 6px !important;
  }

  .user-dropdown {
    right: 8px !important;
    min-width: 280px !important;
  }
}

/* ===================================
   MOBILE TYPOGRAPHY ENHANCEMENTS
   =================================== */

@media (max-width: 768px) {
  /* Improved text sizing */
  h1 { font-size: 24px !important; line-height: 1.2 !important; }
  h2 { font-size: 20px !important; line-height: 1.3 !important; }
  h3 { font-size: 18px !important; line-height: 1.3 !important; }
  h4 { font-size: 16px !important; line-height: 1.4 !important; }
  
  /* Body text improvements */
  body {
    font-size: 14px !important;
    line-height: 1.5 !important;
  }

  /* Better text contrast */
  .muted,
  .sub,
  .detail-label {
    color: #5f6368 !important;
    font-size: 13px !important;
  }
}

/* ===================================
   MOBILE SPACING ENHANCEMENTS
   =================================== */

@media (max-width: 768px) {
  /* Consistent padding */
  .container {
    padding: 0 16px !important;
  }

  .content-padding {
    padding: 0 16px !important;
  }

  /* Section spacing */
  .main-area > * + * {
    margin-top: 16px !important;
  }

  /* Card spacing */
  .card + .card {
    margin-top: 16px !important;
  }
}

/* ===================================
   MOBILE ANIMATION ENHANCEMENTS
   =================================== */

@media (max-width: 768px) {
  /* Smooth transitions */
  * {
    transition-duration: 0.2s !important;
  }

  /* Reduce motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    * {
      transition: none !important;
      animation: none !important;
    }
  }

  /* Touch feedback */
  button:active,
  .btn:active,
  .nav-link:active {
    transform: scale(0.98) !important;
    opacity: 0.8 !important;
  }
}

/* ===================================
   MOBILE ACCESSIBILITY ENHANCEMENTS
   =================================== */

@media (max-width: 768px) {
  /* Focus indicators */
  button:focus,
  input:focus,
  select:focus,
  textarea:focus,
  .btn:focus,
  .nav-link:focus {
    outline: 2px solid #1a73e8 !important;
    outline-offset: 2px !important;
  }

  /* High contrast mode support */
  @media (prefers-contrast: high) {
    .card,
    .modal,
    .sidebar {
      border: 2px solid #000 !important;
    }
    
    button,
    .btn {
      border: 2px solid #000 !important;
    }
  }

  /* Large text support */
  @media (prefers-font-size: large) {
    body {
      font-size: 18px !important;
    }
    
    .btn,
    button {
      font-size: 18px !important;
      padding: 16px 20px !important;
    }
  }
}

/* ===================================
   MOBILE PERFORMANCE OPTIMIZATIONS
   =================================== */

@media (max-width: 768px) {
  /* GPU acceleration for smooth animations */
  .sidebar,
  .modal,
  .mobile-overlay {
    transform: translateZ(0) !important;
    will-change: transform !important;
  }

  /* Optimize scrolling */
  .table-container,
  .modal-content,
  .sidebar-nav {
    -webkit-overflow-scrolling: touch !important;
  }

  /* Reduce repaints */
  .floating-icons,
  .floating-icon {
    will-change: transform !important;
  }
}

/* ===================================
   SMALL MOBILE DEVICES (≤480px)
   =================================== */

@media (max-width: 480px) {
  /* Extra small device optimizations */
  .header {
    padding: 8px 12px 8px 60px !important;
  }

  .sidebar {
    width: 100% !important;
  }

  .user-profile-btn {
    min-width: 120px !important;
    padding: 6px 8px !important;
  }

  .user-name {
    max-width: 60px !important;
  }

  .modal,
  .exam-sheet-modal {
    border-radius: 12px 12px 0 0 !important;
  }

  /* Smaller touch targets for very small screens */
  .btn,
  button {
    min-height: 40px !important;
    font-size: 13px !important;
  }

  /* Compact table */
  .exams-table th,
  .exams-table td {
    padding: 8px 4px !important;
    font-size: 12px !important;
  }
}

/* ===================================
   LANDSCAPE MOBILE ORIENTATION
   =================================== */

@media (max-width: 768px) and (orientation: landscape) {
  .main-area {
    padding-top: 60px !important;
  }

  .header {
    padding: 8px 16px 8px 60px !important;
  }

  .mobile-menu-toggle,
  .sidebar-toggle {
    top: 8px !important;
    width: 44px !important;
    height: 44px !important;
  }

  /* Optimize for landscape */
  .modal {
    max-height: 85vh !important;
  }
}

/* ===================================
   DARK MODE MOBILE SUPPORT
   =================================== */

@media (max-width: 768px) {
  [data-theme="dark"] .mobile-menu-toggle,
  [data-theme="dark"] .sidebar-toggle {
    background: linear-gradient(135deg, #4285f4, #34a853) !important;
  }

  [data-theme="dark"] .mobile-overlay {
    background: rgba(0, 0, 0, 0.7) !important;
  }

  [data-theme="dark"] .modal,
  [data-theme="dark"] .exam-sheet-modal {
    background: #1f1f1f !important;
    color: #ffffff !important;
  }
}

/* ===================================
   PRINT STYLES FOR MOBILE
   =================================== */

@media print {
  .mobile-menu-toggle,
  .sidebar-toggle,
  .sidebar,
  .mobile-overlay,
  .user-dropdown,
  .fab,
  .modal-overlay {
    display: none !important;
  }

  .main-area {
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
  }

  .header {
    position: static !important;
    padding: 10px !important;
  }
}
